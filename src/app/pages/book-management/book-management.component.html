<div class="container mt-5" dir="rtl">

  <h2 class="mb-4 text-center">إدارة الكتب</h2>

  <!-- إضافة كتاب جديد -->
  <form (ngSubmit)="addBook()" #bookForm="ngForm" class="row g-3 mb-5">

    <div class="col-md-6">
      <input type="text" class="form-control" [(ngModel)]="newBook.name" name="name" placeholder="اسم الكتاب" required />
    </div>

    <div class="col-md-6">
      <input type="text" class="form-control" [(ngModel)]="newBook.link" name="link" placeholder="رابط الكتاب" />
    </div>

    <div class="col-12">
      <textarea class="form-control" [(ngModel)]="newBook.description" name="description" placeholder="وصف الكتاب" rows="3" required></textarea>
    </div>

    <div class="col-12">
      <input type="text" class="form-control" [(ngModel)]="newBook.image" name="image" placeholder="رابط صورة الكتاب" />
    </div>

    <div class="col-12 text-center">
      <button type="submit" class="btn add maintextcolor mainbordercolor border-1" [disabled]="loading">إضافة كتاب</button>
    </div>

  </form>


  <hr class="my-4" />

  <!-- التبويبات بين الجدول والكروت -->
  <ul class="nav nav-tabs mb-4" id="bookTabs" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active" id="table-tab" data-bs-toggle="tab" data-bs-target="#tableView" type="button" role="tab" aria-controls="tableView" aria-selected="true">عرض كجدول</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="card-tab" data-bs-toggle="tab" data-bs-target="#cardView" type="button" role="tab" aria-controls="cardView" aria-selected="false">عرض ككروت</button>
    </li>
  </ul>

  <div class="tab-content" id="bookTabsContent">

    <!-- جدول الكتب -->
    <div class="tab-pane fade show active" id="tableView" role="tabpanel" aria-labelledby="table-tab">
      <div class="table-responsive">
        <table class="table table-bordered table-hover text-center align-middle">
          <thead class="table-dark">
            <tr>
              <th>اسم الكتاب</th>
              <th>الوصف</th>
              <th>الرابط</th>
              <th>الصورة</th>
              <th>التحكم</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let book of tempBooks">
              <td>
                <input type="text" class="form-control" [(ngModel)]="book.name" name="book-name-{{book.id}}" />
              </td>
              <td>
                <textarea class="form-control" [(ngModel)]="book.description" name="book-description-{{book.id}}" rows="2"></textarea>
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="book.link" name="book-link-{{book.id}}" />
              </td>
              <td>
                <div *ngIf="book.image">
                  <img [src]="book.image" alt="صورة الكتاب" class="img-thumbnail" style="max-width: 100px; max-height: 100px;">
                </div>
              </td>
              <td>
                <div class="d-flex justify-content-between">
                  <button class="btn text-white btn-warning btn-sm" (click)="updateBook(book)"><i class="fa-solid fa-pen"></i></button>
                  <button class="btn btn-danger btn-sm" (click)="deleteBook(book.id)"><i class="fa-solid fa-trash"></i></button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- كروت عرض الكتب -->
    <div class="tab-pane fade" id="cardView" role="tabpanel" aria-labelledby="card-tab">
      <div class="row">
        <div class="col-md-4 mb-4" *ngFor="let book of tempBooks">
          <div class="card h-100 shadow-sm">
            <img *ngIf="book.image" [src]="book.image" class="card-img-top" alt="صورة الكتاب" style="height: 250px; object-fit: cover;">
            <div class="card-body d-flex flex-column">
              <h5 class="card-title">{{ book.name }}</h5>
              <p class="card-text text-truncate" title="{{ book.description }}">{{ book.description }}</p>
              <a *ngIf="book.link" [href]="book.link" target="_blank" class="btn btn-outline-primary btn-sm mt-auto">رابط الكتاب</a>
            </div>
            <div class="card-footer bg-transparent border-top-0 d-flex justify-content-between">
              <button class="btn text-white btn-warning btn-sm" (click)="updateBook(book)"><i class="fa-solid fa-pen"></i></button>
              <button class="btn btn-danger btn-sm" (click)="deleteBook(book.id)"><i class="fa-solid fa-trash"></i></button>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>

</div>
